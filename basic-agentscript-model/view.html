<html>
    <head>
        <title>Basic Model</title>
    </head>
    <body>
        <script type="module">
            import * as util from './src/utils.js'
            import ThreeDraw from './src/ThreeDraw.js'
            import Model from './model.js'
            import ColorMap from './src/ColorMap.js'

            let myColorMap = ColorMap.gradientColorMap(8, ['black', 'green'])
            //let pleasework = ['black', 'green']
            //let myColorMap = ColorMap.basicColorMap('black', 'green')

            const drawOptions = {
                // Set colors and the likes
                patchesColor: (patch) => myColorMap.scaleColor(
                    Math.round(patch.value), 0, 1
                ),
                //patchesColor: p => {if (p.value <= .5) return 'green'},
                turtlesShape: 'Sphere',
                turtlesColor: 'red',
                turtlesSize: 2,
            }

            async function run() {
                const model = new Model()
                await model.startup()
                model.setup()

                const view = new ThreeDraw(
                    model,
                    {
                        turtles: { meshClass: 'Obj3DMesh', useAxes: false }, // Still not fully sure what this line does but without it nothing works.
                        useAxes: false,
                        useGrid: false,
                    },
                    drawOptions
                )

                util.toWindow({ util, model, view })

                await util.timeoutLoop(
                    () => {
                        model.step()
                        view.draw()
                    },
                )
            }
            run()
        </script>
        <div id="modelDiv"></div>
    </body>
</html>
